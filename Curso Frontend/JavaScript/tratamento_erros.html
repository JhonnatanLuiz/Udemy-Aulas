<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tratamento de Erros - Try, Catch, Throw, Finally</title>
</head>
<body>
    <h1 style="text-align: center;">Tratamento de Erros em JavaScript</h1>
    <p style="text-align: center;">Abra o Console (F12) para ver os exemplos!</p>
    
    <script>
        console.log('%c=== TRATAMENTO DE ERROS EM JAVASCRIPT ===', 'color: blue; font-size: 18px; font-weight: bold;');
        console.log('');

        // ========================================
        // EXEMPLO 1: Try-Catch B√°sico
        // ========================================
        // Try-Catch permite capturar erros sem quebrar o c√≥digo
        console.log('%c1. TRY-CATCH B√ÅSICO', 'color: green; font-weight: bold;');
        
        try {
            // C√≥digo que pode gerar erro
            console.log('Tentando executar c√≥digo...');
            let resultado = 10 / 0; // Isso n√£o gera erro em JS (retorna Infinity)
            console.log('Resultado:', resultado);
            
            // Mas isso gera erro:
            let obj = null;
            console.log(obj.propriedade); // TypeError: Cannot read property of null
        } catch (erro) {
            // Captura o erro e exibe informa√ß√µes
            console.error('‚ùå Erro capturado:', erro.message);
            console.log('Tipo do erro:', erro.name);
        }
        console.log('‚úÖ O programa continua executando normalmente!');
        console.log('---\n');

        // ========================================
        // EXEMPLO 2: Finally - Sempre Executa
        // ========================================
        // Finally √© executado sempre, com ou sem erro
        console.log('%c2. TRY-CATCH-FINALLY', 'color: green; font-weight: bold;');
        
        function testarFinally(causarErro) {
            try {
                console.log('üîÑ Iniciando opera√ß√£o...');
                
                if (causarErro) {
                    throw new Error('Erro proposital!');
                }
                
                console.log('‚úÖ Opera√ß√£o conclu√≠da com sucesso!');
                return 'Sucesso';
            } catch (erro) {
                console.error('‚ùå Erro:', erro.message);
                return 'Falha';
            } finally {
                // Finally SEMPRE executa, mesmo com return
                console.log('üßπ Finally: Limpando recursos...');
                console.log('(Finally executa mesmo com return no try ou catch)');
            }
        }
        
        console.log('Teste 1 - Sem erro:');
        testarFinally(false);
        console.log('');
        
        console.log('Teste 2 - Com erro:');
        testarFinally(true);
        console.log('---\n');

        // ========================================
        // EXEMPLO 3: Throw - Lan√ßando Erros
        // ========================================
        // Throw permite criar e lan√ßar seus pr√≥prios erros
        console.log('%c3. THROW - LAN√áANDO ERROS CUSTOMIZADOS', 'color: green; font-weight: bold;');
        
        function dividir(a, b) {
            // Valida√ß√£o de par√¢metros
            if (typeof a !== 'number' || typeof b !== 'number') {
                throw new TypeError('Os par√¢metros devem ser n√∫meros!');
            }
            
            if (b === 0) {
                throw new Error('Divis√£o por zero n√£o √© permitida!');
            }
            
            return a / b;
        }
        
        try {
            console.log('10 / 2 =', dividir(10, 2)); // OK
            console.log('10 / 0 =', dividir(10, 0)); // Erro!
        } catch (erro) {
            console.error('‚ùå Erro:', erro.message);
        }
        
        try {
            console.log(dividir('10', 2)); // Erro de tipo!
        } catch (erro) {
            console.error('‚ùå Erro:', erro.message);
        }
        console.log('---\n');

        // ========================================
        // EXEMPLO 4: Valida√ß√£o de Idade
        // ========================================
        console.log('%c4. VALIDA√á√ÉO COM THROW', 'color: green; font-weight: bold;');
        
        function validarIdade(idade) {
            try {
                if (typeof idade !== 'number') {
                    throw new TypeError('Idade deve ser um n√∫mero!');
                }
                
                if (idade < 0) {
                    throw new RangeError('Idade n√£o pode ser negativa!');
                }
                
                if (idade < 18) {
                    throw new Error('Voc√™ deve ter pelo menos 18 anos!');
                }
                
                console.log('‚úÖ Idade v√°lida:', idade);
                return true;
            } catch (erro) {
                console.error('‚ùå', erro.name + ':', erro.message);
                return false;
            }
        }
        
        validarIdade(25);      // OK
        validarIdade(15);      // Menor de idade
        validarIdade(-5);      // Negativa
        validarIdade('vinte'); // Tipo errado
        console.log('---\n');

        // ========================================
        // EXEMPLO 5: Erros em Fun√ß√µes Ass√≠ncronas
        // ========================================
        console.log('%c5. TRATAMENTO EM FUN√á√ïES ASS√çNCRONAS', 'color: green; font-weight: bold;');
        
        async function buscarUsuario(id) {
            try {
                console.log('üîç Buscando usu√°rio com ID:', id);
                
                // Simula uma requisi√ß√£o que pode falhar
                if (id <= 0) {
                    throw new Error('ID inv√°lido!');
                }
                
                // Simula sucesso
                await new Promise(resolve => setTimeout(resolve, 100));
                console.log('‚úÖ Usu√°rio encontrado!');
                return { id: id, nome: 'Jo√£o' };
                
            } catch (erro) {
                console.error('‚ùå Erro ao buscar usu√°rio:', erro.message);
                return null;
            } finally {
                console.log('üèÅ Finalizando busca...');
            }
        }
        
        // Testando a fun√ß√£o ass√≠ncrona
        buscarUsuario(1).then(resultado => {
            console.log('Resultado 1:', resultado);
        });
        
        buscarUsuario(-1).then(resultado => {
            console.log('Resultado 2:', resultado);
        });
        
        setTimeout(() => console.log('---\n'), 200);

        // ========================================
        // EXEMPLO 6: M√∫ltiplos Catches (Tipos de Erro)
        // ========================================
        setTimeout(() => {
            console.log('%c6. TRATAMENTO POR TIPO DE ERRO', 'color: green; font-weight: bold;');
            
            function processarDados(dados) {
                try {
                    if (!dados) {
                        throw new ReferenceError('Dados n√£o fornecidos!');
                    }
                    
                    if (typeof dados !== 'object') {
                        throw new TypeError('Dados devem ser um objeto!');
                    }
                    
                    if (!dados.nome) {
                        throw new Error('Campo "nome" √© obrigat√≥rio!');
                    }
                    
                    console.log('‚úÖ Dados v√°lidos:', dados.nome);
                    
                } catch (erro) {
                    // Trata diferentes tipos de erro
                    if (erro instanceof ReferenceError) {
                        console.error('‚ùå ReferenceError:', erro.message);
                    } else if (erro instanceof TypeError) {
                        console.error('‚ùå TypeError:', erro.message);
                    } else {
                        console.error('‚ùå Erro gen√©rico:', erro.message);
                    }
                }
            }
            
            processarDados({ nome: 'Maria' }); // OK
            processarDados('texto');            // TypeError
            processarDados(null);               // ReferenceError
            processarDados({});                 // Error gen√©rico
            console.log('---\n');
        }, 300);

        // ========================================
        // EXEMPLO 7: Calculadora com Tratamento de Erros
        // ========================================
        setTimeout(() => {
            console.log('%c7. CALCULADORA COM TRATAMENTO DE ERROS', 'color: green; font-weight: bold;');
            
            function calculadora(num1, operador, num2) {
                try {
                    // Valida√ß√µes
                    if (typeof num1 !== 'number' || typeof num2 !== 'number') {
                        throw new TypeError('Os valores devem ser n√∫meros!');
                    }
                    
                    if (isNaN(num1) || isNaN(num2)) {
                        throw new Error('Valores inv√°lidos (NaN)!');
                    }
                    
                    // Opera√ß√µes
                    let resultado;
                    switch(operador) {
                        case '+':
                            resultado = num1 + num2;
                            break;
                        case '-':
                            resultado = num1 - num2;
                            break;
                        case '*':
                            resultado = num1 * num2;
                            break;
                        case '/':
                            if (num2 === 0) {
                                throw new Error('Divis√£o por zero!');
                            }
                            resultado = num1 / num2;
                            break;
                        default:
                            throw new Error('Operador inv√°lido! Use: +, -, *, /');
                    }
                    
                    console.log(`‚úÖ ${num1} ${operador} ${num2} = ${resultado}`);
                    return resultado;
                    
                } catch (erro) {
                    console.error('‚ùå Erro na calculadora:', erro.message);
                    return null;
                } finally {
                    console.log('üìä Opera√ß√£o finalizada');
                }
            }
            
            calculadora(10, '+', 5);   // OK
            calculadora(10, '/', 2);   // OK
            calculadora(10, '/', 0);   // Erro: divis√£o por zero
            calculadora(10, '%', 2);   // Erro: operador inv√°lido
            calculadora('10', '+', 5); // Erro: tipo inv√°lido
            console.log('---\n');
        }, 400);

        // ========================================
        // EXEMPLO 8: Try-Catch em Array Operations
        // ========================================
        setTimeout(() => {
            console.log('%c8. TRATAMENTO EM OPERA√á√ïES DE ARRAY', 'color: green; font-weight: bold;');
            
            function buscarPorIndice(array, indice) {
                try {
                    if (!Array.isArray(array)) {
                        throw new TypeError('O primeiro par√¢metro deve ser um array!');
                    }
                    
                    if (typeof indice !== 'number') {
                        throw new TypeError('O √≠ndice deve ser um n√∫mero!');
                    }
                    
                    if (indice < 0 || indice >= array.length) {
                        throw new RangeError(`√çndice ${indice} fora do intervalo v√°lido (0-${array.length - 1})`);
                    }
                    
                    console.log(`‚úÖ Elemento no √≠ndice ${indice}:`, array[indice]);
                    return array[indice];
                    
                } catch (erro) {
                    console.error('‚ùå', erro.name + ':', erro.message);
                    return undefined;
                }
            }
            
            const frutas = ['Ma√ß√£', 'Banana', 'Laranja'];
            
            buscarPorIndice(frutas, 1);     // OK
            buscarPorIndice(frutas, 5);     // RangeError
            buscarPorIndice(frutas, '1');   // TypeError
            buscarPorIndice('texto', 0);    // TypeError
            console.log('---\n');
        }, 500);

        // ========================================
        // EXEMPLO 9: Valida√ß√£o de Formul√°rio
        // ========================================
        setTimeout(() => {
            console.log('%c9. VALIDA√á√ÉO DE FORMUL√ÅRIO', 'color: green; font-weight: bold;');
            
            function validarFormulario(dados) {
                const erros = [];
                
                try {
                    // Email
                    if (!dados.email || !dados.email.includes('@')) {
                        throw new Error('Email inv√°lido!');
                    }
                    
                    // Senha
                    if (!dados.senha || dados.senha.length < 6) {
                        throw new Error('Senha deve ter no m√≠nimo 6 caracteres!');
                    }
                    
                    // Nome
                    if (!dados.nome || dados.nome.trim() === '') {
                        throw new Error('Nome √© obrigat√≥rio!');
                    }
                    
                    console.log('‚úÖ Formul√°rio v√°lido!');
                    return { valido: true, erros: [] };
                    
                } catch (erro) {
                    console.error('‚ùå', erro.message);
                    erros.push(erro.message);
                    return { valido: false, erros: erros };
                } finally {
                    console.log('üîç Valida√ß√£o conclu√≠da');
                }
            }
            
            // Teste 1: Dados v√°lidos
            console.log('Teste 1:');
            validarFormulario({
                email: 'joao@email.com',
                senha: '123456',
                nome: 'Jo√£o Silva'
            });
            
            // Teste 2: Email inv√°lido
            console.log('\nTeste 2:');
            validarFormulario({
                email: 'emailinvalido',
                senha: '123456',
                nome: 'Jo√£o'
            });
            
            // Teste 3: Senha curta
            console.log('\nTeste 3:');
            validarFormulario({
                email: 'maria@email.com',
                senha: '123',
                nome: 'Maria'
            });
            console.log('---\n');
        }, 600);

        // ========================================
        // EXEMPLO 10: Erros Customizados (Custom Error)
        // ========================================
        setTimeout(() => {
            console.log('%c10. CRIANDO ERROS CUSTOMIZADOS', 'color: green; font-weight: bold;');
            
            // Classe de erro personalizada
            class ErroDeValidacao extends Error {
                constructor(mensagem) {
                    super(mensagem);
                    this.name = 'ErroDeValidacao';
                    this.data = new Date();
                }
            }
            
            class ErroDeAutenticacao extends Error {
                constructor(mensagem) {
                    super(mensagem);
                    this.name = 'ErroDeAutenticacao';
                    this.codigo = 401;
                }
            }
            
            function login(usuario, senha) {
                try {
                    if (!usuario || !senha) {
                        throw new ErroDeValidacao('Usu√°rio e senha s√£o obrigat√≥rios!');
                    }
                    
                    if (usuario !== 'admin') {
                        throw new ErroDeAutenticacao('Usu√°rio n√£o encontrado!');
                    }
                    
                    if (senha !== 'senha123') {
                        throw new ErroDeAutenticacao('Senha incorreta!');
                    }
                    
                    console.log('‚úÖ Login realizado com sucesso!');
                    return true;
                    
                } catch (erro) {
                    if (erro instanceof ErroDeValidacao) {
                        console.error('‚ùå Valida√ß√£o:', erro.message, '| Data:', erro.data);
                    } else if (erro instanceof ErroDeAutenticacao) {
                        console.error('‚ùå Autentica√ß√£o:', erro.message, '| C√≥digo:', erro.codigo);
                    } else {
                        console.error('‚ùå Erro desconhecido:', erro.message);
                    }
                    return false;
                }
            }
            
            login('admin', 'senha123');  // OK
            login('', 'senha123');       // ErroDeValidacao
            login('user', 'senha123');   // ErroDeAutenticacao
            login('admin', 'errada');    // ErroDeAutenticacao
            
            console.log('\n%c=== FIM DOS EXEMPLOS ===', 'color: blue; font-size: 16px; font-weight: bold;');
        }, 700);

    </script>
</body>
</html>